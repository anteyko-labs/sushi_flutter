# Исправления для корзины и избранного

## Проблема
Корзина и избранное не работали в Flutter приложении, потому что:
1. Flutter приложение на мобильном устройстве не могло подключиться к `localhost:5000`
2. `localhost` на мобильном устройстве - это само устройство, а не ваш компьютер

## Решение
1. ✅ **Исправлены модели данных**:
   - `Roll.cost` → `Roll.costPrice` (соответствует API)
   - `CartItem` теперь хранит `price` как отдельное поле
   - `FavoriteItem` корректно парсит данные из API

2. ✅ **Обновлены URL в сервисах**:
   - `localhost:5000` → `172.16.4.51:5000` (ваш реальный IP-адрес)
   - Обновлены: `CartService`, `FavoritesService`, `ApiUserService`, `ApiService`

3. ✅ **Добавлена автоматическая загрузка**:
   - `CartService` и `FavoritesService` автоматически загружают данные при инициализации

4. ✅ **API работает корректно**:
   - Сервер слушает на всех интерфейсах (`host='0.0.0.0'`)
   - Корзина и избранное сохраняются в базе данных
   - Возвращаются полные данные роллов/сетов

## Что нужно сделать
1. **Перезапустить Flutter приложение** (полный перезапуск, не горячая перезагрузка)
2. **Убедиться, что мобильное устройство и компьютер в одной сети**
3. **Проверить, что сервер запущен**: `python app_sqlite.py` в папке `backend`

## Тестирование
После перезапуска Flutter приложения:
1. Добавьте товар в корзину (кнопка с корзинкой)
2. Добавьте товар в избранное (кнопка с сердечком)
3. Перейдите в корзину - товары должны отображаться
4. Перейдите в избранное - товары должны отображаться

## Отладка
Если проблемы остаются, проверьте консоль Flutter на наличие ошибок подключения к `172.16.4.51:5000`.

## Важно
- IP-адрес `172.16.4.51` может измениться при переподключении к сети
- Если IP изменился, обновите его во всех сервисах
- Для проверки IP используйте команду `ipconfig` в Windows
